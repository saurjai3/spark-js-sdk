/*!
 * Copyright (c) 2015-2018 Cisco Systems, Inc. See LICENSE file.
 */
import {find} from 'lodash';

import request from './request.js';

function fetchInfo(meetingInfoList, id) {
  return find(this.meetingInfoList, (info) => info.sipUrl === id || info.locusId === id || info.userId === id
        || info.meetingLink === id);
}

const MeetingInfo = {
  meetingInfoList: {},

  /**
   * @param {string} id
   * @returns {object}
    * @memberof MeetingInfo
     */
  get(id) {
    if (this.meetingInfoList[id]) {
      return this.meetingInfoList[id];
    }
    return fetchInfo(this.meetingInfoList, id);
  },

  /**
   * @param {string} id
   * @param {object} info
     * @returns {null}
    * @memberof MeetingInfo
     */
  set(id, info) {
    const meetingInfo = fetchInfo(this.meetingInfoList, id);
    if (meetingInfo) {
      this.meetingInfoList[meetingInfo.id] = info;
    }
    else {
      this.meetingInfoList[id] = info;
      this.meetingInfoList[id].id = id;
    }
  },

  // TODO: check with locus if there is a update in the meeting info anytime

  update(/* id , info */) {
    // request.requestMeetingInfo();
  },

  getMeetingInfo(options) {
    options = {
      value: 'chdubois@go.webex.com',
      type: 'SIP_URI'
    };

    request.requestMeetingInfo(options);
  }
};

export default MeetingInfo;

